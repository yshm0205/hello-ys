# 어드민 콘솔

어드민 콘솔은 우리 서비스의 성장을 한눈에 확인하고, 고객을 관리할 수 있는 페이지예요. **Supabase** 데이터베이스와 연결되어 있어 **Lemon Squeezy** 결제 내역도 실시간으로 볼 수 있답니다.

---

## 🔐 관리자 설정 방법

어드민 페이지는 보안을 위해 특정 사용자만 접근할 수 있어요.  
**현재 코드에는 이미 권한 체크 로직이 적용되어 있습니다.**

### 1단계: 환경변수 설정하기

`.env.local` 파일에 `ADMIN_EMAILS` 변수를 추가하고, 어드민 권한을 주고 싶은 이메일 주소를 쉼표(`,`)로 구분해서 입력하세요.

```bash
# .env.local
ADMIN_EMAILS=admin@example.com,your-email@gmail.com
```

### 2단계: 배포 환경에도 추가하기

Vercel 같은 곳에 배포하셨다면, 배포 사이트의 환경변수 설정(Environment Variables)에도 `ADMIN_EMAILS`를 꼭 추가해주세요!

---

## 📊 데이터 연동 현황

현재 어드민 개요 페이지는 다음과 같이 실데이터를 반영하고 있어요:

- **MRR**: 활성 구독자 수 기반 자동 계산
- **Active Subscribers**: DB의 `subscriptions` 테이블 실시간 집계
- **Sales Today**: 최근 24시간 내 발생한 새로운 구독 수
- **Recent Subscriptions**: 최신 구독 내역 리스트 (User ID 포함)

---

## 🚀 어떤 기능을 쓸 수 있나요?

1.  **대시보드 개요 (`/admin/overview`)**
    - **MRR (월간 반복 매출)**: 활성 구독자 수를 바탕으로 이번 달 예상 매출을 보여드려요.
    - **활성 구독자**: 지금 서비스를 구독 중인 고객이 몇 명인지 알 수 있어요.
    - **최근 판매**: 방금 구독을 시작한 고객 내역을 실시간으로 확인해보세요.

2.  **데이터 관리 공통 (Search, Filter, Pagination)**
    - **강력한 검색**: 고객 이메일, 제품 이름, 티켓 제목 등으로 필요한 데이터를 즉시 찾으세요.
    - **스마트 필터**: 구독 상태나 티켓 상태별로 리스트를 정렬하고 모아볼 수 있어요.
    - **페이지네이션**: 대량의 데이터도 속도 저하 없이 10개 단위로 나누어 확인해요.

3.  **고객 관리 (`/admin/customers`)**
    - 우리 서비스를 이용 중인 모든 고객 정보를 모아볼 수 있어요.
    - 고객의 구독 상태(`active`, `cancelled` 등), 이용 중인 플랜(Basic/Pro), 다음 결제일 등을 확인해보세요.

4.  **결제 내역 (`/admin/sales`)**
    - 모든 결제 내역(일회성 및 구독)을 시간순으로 확인하고 시각적으로 관리해요.

5.  **기타 편의 기능**
    - **테마 전환**: 어드민 네비게이션 바 우측의 🌓 버튼으로 다크/라이트 모드를 자유롭게 바꿀 수 있어요.

---

## 📊 데이터는 어떻게 불러오나요?

- **MRR 계산**: 지금은 `활성 구독자 수` × `$19` (Basic 플랜 가격)로 간단하게 계산해서 보여주고 있어요. 플랜별 가격을 정확하게 반영하려면 `src/app/[locale]/admin/overview/page.tsx` 파일의 `getAdminStats()` 함수를 조금만 수정해주시면 돼요.
- **구독자 수**: 데이터베이스의 `subscriptions` 테이블에서 구독 상태가 `active`인 사용자만 쏙 골라서 세고 있어요.
